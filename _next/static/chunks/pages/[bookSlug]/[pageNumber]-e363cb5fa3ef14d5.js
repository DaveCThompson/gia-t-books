(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[950],{2161:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[bookSlug]/[pageNumber]",function(){return a(7079)}])},7079:function(e,t,a){"use strict";a.r(t),a.d(t,{__N_SSG:function(){return B},default:function(){return R}});var n=a(5893),r=a(7294),s=a(1163),i=a(7973),o=a(1993),l=a(782);let c=(0,o.U)()((0,l.tJ)(e=>({readingMode:"selfRead",toggleReadingMode:()=>e(e=>({readingMode:"narrated"===e.readingMode?"selfRead":"narrated"}))}),{name:"gia-t-books-settings"}));var u=a(1766);let d=()=>{let[e,t]=(0,r.useState)(!1),a=(0,r.useRef)(null),n=(0,r.useCallback)(()=>{a.current&&a.current.stop()},[]),s=(0,r.useCallback)(e=>{a.current&&a.current.stop();let n=new u.Howl({src:[e],html5:!0,onplay:()=>t(!0),onpause:()=>t(!1),onstop:()=>t(!1),onend:()=>t(!1)});n.play(),a.current=n},[]);return(0,r.useEffect)(()=>()=>{n()},[n]),{play:s,stop:n,isPlaying:e}};var _=a(5675),g=a.n(_),p=a(106),x=a(221),v=a.n(x);let h=/\[(\w+)(?::([^\]]+))?\](.*?)\[\/\1\]/g,f=e=>{let{text:t}=e,a=t.split(h),s=[];for(let e=0;e<a.length;e+=4){a[e]&&s.push((0,n.jsx)(r.Fragment,{children:a[e]},"text-".concat(e)));let t=a[e+1],i=a[e+2],o=a[e+3];if(t){if("interactive"===t)s.push((0,n.jsxs)(p.fC,{children:[(0,n.jsx)(p.xz,{asChild:!0,children:(0,n.jsx)("span",{className:v().interactiveWord,children:o})}),(0,n.jsx)(p.h_,{children:(0,n.jsxs)(p.VY,{className:v().tooltipContent,sideOffset:5,children:[i||"No definition available.",(0,n.jsx)(p.Eh,{className:v().tooltipArrow})]})})]},"interactive-".concat(e)));else if("expressive"===t){let t=v().expressiveDefault;switch(i){case"shout":t=v().expressiveShout;break;case"bully":t=v().expressiveBully;break;case"handwritten":t=v().expressiveHandwritten}s.push((0,n.jsx)("span",{className:t,children:o},"expressive-".concat(e)))}}}return(0,n.jsx)(n.Fragment,{children:s})};var N=e=>{let{pageData:t}=e;return(0,n.jsx)(p.zt,{delayDuration:100,children:(0,n.jsxs)("div",{className:v().pageContainer,children:[t.illustration&&(0,n.jsx)("div",{className:v().imageContainer,style:{maskImage:"url(".concat(t.mask,")"),WebkitMaskImage:"url(".concat(t.mask,")")},children:(0,n.jsx)(g(),{src:t.illustration,alt:"Illustration for page ".concat(t.pageNumber),fill:!0,className:v().imageFill,priority:!0})}),(0,n.jsx)("p",{className:v().text,children:(0,n.jsx)(f,{text:t.text})})]})})},m=a(3858),C=a.n(m),j=()=>{let{readingMode:e,toggleReadingMode:t}=c();return(0,n.jsx)("div",{className:C().controlsContainer,children:(0,n.jsx)("button",{onClick:t,className:C().toggleButton,children:"narrated"===e?'Switch to "I\'ll Read"':'Switch to "Read to Me"'})})},b=a(8873),k=a.n(b),w=e=>{let{currentPage:t,totalPages:a,onPrev:r,onNext:s,onPlayPause:i,isPlaying:o,hasNarration:l}=e;return(0,n.jsxs)("div",{className:k().navContainer,children:[(0,n.jsx)("button",{onClick:r,disabled:1===t,className:k().navButton,children:"← Prev"}),(0,n.jsxs)("div",{className:k().pageInfo,children:[(0,n.jsx)("button",{onClick:i,disabled:!l,className:k().playButton,children:o?"❚❚":"▶"}),(0,n.jsxs)("span",{children:["Page ",t," of ",a]})]}),(0,n.jsx)("button",{onClick:s,disabled:t===a,className:k().navButton,children:"Next →"})]})},P=a(3256),S=a.n(P),y=e=>{let{bookData:t,currentPage:a}=e,o=(0,s.useRouter)(),{readingMode:l}=c(),{play:u,stop:_,isPlaying:g}=d(),[p,x]=(0,r.useState)(null),[v,h]=(0,r.useState)(t.pages[a-1]);(0,r.useEffect)(()=>{"narrated"===l&&(null==v?void 0:v.narrationUrl)?u(v.narrationUrl):_()},[l,v,u,_]);let f=(0,r.useCallback)(()=>{null==p||p.slidePrev()},[p]),m=(0,r.useCallback)(()=>{null==p||p.slideNext()},[p]),C=(0,r.useCallback)(()=>{g?_():(null==v?void 0:v.narrationUrl)&&u(v.narrationUrl)},[g,v,u,_]);return(0,n.jsxs)("div",{className:S().bookReaderContainer,children:[(0,n.jsx)(w,{currentPage:v.pageNumber,totalPages:t.pages.length,onPrev:f,onNext:m,onPlayPause:C,isPlaying:g,hasNarration:!!v.narrationUrl}),(0,n.jsx)(i.tq,{onSwiper:x,initialSlide:a-1,onSlideChange:e=>{let a=e.activeIndex+1;h(t.pages[e.activeIndex]);let n="/".concat(t.slug,"/").concat(a);o.replace(n,void 0,{shallow:!0})},className:S().swiperContainer,children:t.pages.map(e=>(0,n.jsx)(i.o5,{children:(0,n.jsx)(N,{pageData:e})},e.pageNumber))}),(0,n.jsx)(j,{})]})},B=!0,R=e=>{let{bookData:t,currentPage:a}=e;return t?(0,n.jsx)(y,{bookData:t,currentPage:a}):(0,n.jsx)("div",{children:"Book not found."})}},3256:function(e){e.exports={bookReaderContainer:"BookReader_bookReaderContainer__8vFG2",swiperContainer:"BookReader_swiperContainer__E59gN"}},3858:function(e){e.exports={controlsContainer:"NarrationControls_controlsContainer__QeY40",toggleButton:"NarrationControls_toggleButton__QfeH0"}},8873:function(e){e.exports={navContainer:"Navigation_navContainer__tgSFt",navButton:"Navigation_navButton__T1DIF",pageInfo:"Navigation_pageInfo__vzSOd",playButton:"Navigation_playButton__mgpVH"}},221:function(e){e.exports={pageContainer:"Page_pageContainer__MSeIt",imageContainer:"Page_imageContainer__T76HG",imageFill:"Page_imageFill__hAg9f",text:"Page_text__12JOm",interactiveWord:"Page_interactiveWord__XLwgb",expressiveDefault:"Page_expressiveDefault__NyzXE",expressiveShout:"Page_expressiveShout__ip5dE",expressiveBully:"Page_expressiveBully__Pj157",expressiveHandwritten:"Page_expressiveHandwritten__UqyHj",tooltipContent:"Page_tooltipContent__HoROM",tooltipArrow:"Page_tooltipArrow__Q1NaO"}}},function(e){e.O(0,[675,999,888,774,179],function(){return e(e.s=2161)}),_N_E=e.O()}]);